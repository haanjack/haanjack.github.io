---
layout: post
title:  .
date:   2023-01-01 16:40:16
description: .
tags:
categories: cuda programming, parallel programming, performance
taxonomy: llm
published: false
---




# Language Model

**이 내용은 [Stanford CS324](https://stanford-cs324.github.io/winter2022/)에서 소개된 내용을 간략하게 정리한 것입니다.**



## Language model의 정의

Language Model의 기본적인 정의는 확률적 분포로서 단어의 시퀀스를 모델링하는 것입니다. 이는 다음과 같이 표현할 수 있습니다.

$$
P(w_1, w_2, \cdots, w_n)
$$

예를 들어 "개, 꼬리, 흔들, -이/가, -은/는, -을/를, -었다"라는 어휘로 구성된 사전으로부터 문장을 구성한다고 생각해보겠습니다. 이떄, 문장을 구성하는 단어의 시퀀스는 다음과 같이 표현할 수 있습니다.

$$
P(\text{개, -가, 꼬리, -를, 흔들, -었다}) = 0.02 \\
P(\text{꼬리, -가, 개, -를, 흔들, -었다}) = 0.01 \\
P(\text{개, -는, 흔들, -었다, 꼬리, -을}) = 0.0001 \\
$$

여기서 우리는 첫번째 문장이 다른 문장보다 자연스러움을 느낄수 있습니다. 언어 모델은 이를 확률적으로 나타내는 것이며, 자연스러운 문장에 대하여 높은 확률을 부여하는 것이 목표입니다.
언어 모델은 문법적으로 올바름(synthetic knowledge)의 기준으로서 세번째 문장에 대하여 낮은 확률을 부여해야 합니다. 또한 여기서 우리는 한국어적인 특징으로 한국어 모델의 경우 조사의 선별에 대한 올바름도 이해하고 있어야 합니다. 또한 언어모델은 일반적인 지식에 부합함(world knowledge)을 기준으로 두번째 문장 보다는 첫번째 문장에 더 높은 확률을 부여 해야 합니다.

## 문장의 생성

언어 모델을 활용하여 단어의 순서에 대한 적절성에 대한 계산하는 것이 가능하다면, 이를 이용하여 문장을 생성하는 것도 가능합니다. 단순히 생각해보면 언어모델에서 우리가 사용하고자 하는 단어를 선별(sampling)하여 문장을 만들고 이에 대한 확률을 계산할 수 있습니다. 이를 수식으로 표현하면 다음과 같습니다.

$$
\mathrm X_{1:L} ~ p
$$

이것을 기계로부터 효율적으로 계산을 하게 하기 위해서는 어떤 것들을 할 수 있을까요? 우리는 일반적으로 언어모델을 이용해서 위와 같은 방식으로 문장을 생성하지 않습니다. 이는 언어 모델이 갖는 문장의 순서에 따른 현실적인 제약과 관련이 있습니다. 또한 우리는 보편적으로 언어모델의 평균적인 확률을 갖는 문장을 생성하기를 원하기 보다는 자연스럽고 확률이 높은 문장을 만들어 내기를 원합니다.

## 자기 회귀 언어 모델 (Autoregressive Langauge Model)



## 문장의 생성

## 조건 부 생성


여기까지가 기본적인 언어모델의 이해를 위해 정리한 내용입니다. 상세한 내용은 위 정리한 내용의 원문인 [CS324의 첫번째 강의 노트](https://stanford-cs324.github.io/winter2022/lectures/introduction/)를 참고해주시기 바랍니다.